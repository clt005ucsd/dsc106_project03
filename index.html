<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sugar Rush</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>Blood Glucose Trends Throughout the Day</h1>
  <section class="instructions">
    <h2>INSTRUCTIONS</h2>
    <p>This chart shows the blood glucose levels of 16 patients throughout the 5th day of a study.</p>
    <p><strong>If you click on one patient using the legend on the right, you can see the food log for that patient.</strong> Try selecting
      patient 1. Notice how when they ate a high-carb meal at 21:00, their glucose levels spiked. This is a common pattern across all patients</p>
      </p>
    <p>You can hover over the vertical food annotation to see what they ate and the nutrients of their meal.</p>
    <p>You can also select multiple patients, though it won't show the food log for each patient to avoid cluttering</p>
    <p>You can also filter by gender, and reset the selection at any time.</p>
    <p><i>Note: patients 7, 13, 15, and 16 don't have food logs because their food log dates are mismatched with their blood glucose tracking dates. This might have been an error in the study.</i></p>
  </section>
  <div class="controls">
    <button id="reset-button">Reset Selection</button>
  </div>
  <div class="gender-filter">
    <div class="filter-title">Filter by Gender:</div>
    <label class="gender-checkbox">
      <input type="checkbox" id="male-checkbox" checked> Male
    </label>
    <label class="gender-checkbox">
      <input type="checkbox" id="female-checkbox" checked> Female
    </label>
  </div>
  <div id="chart" align="center"></div>
  <p align="center"></p>
  <!-- D3.js -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <!-- your main script -->
  <script src="main.js"></script>

  <section class="project-notes">
    <h2>Design Rationale</h2>
    <p><strong>Visual Encodings:</strong></p>
    <ul>
      <li><b>Line Chart for Glucose Trends:</b> We chose a multi-line chart to show glucose levels over time for each patient. This allows for easy comparison of trends and outliers across individuals.</li>
      <li><b>Color for Patient Identity:</b> Each patient is assigned a unique color, making it easy to distinguish between lines. The legend reinforces this mapping and allows for interactive selection.</li>
      <li><b>Food Log Annotations:</b> When a single patient is selected, vertical bands are overlaid to indicate food log entries. This directly links meal times to glucose responses.</li>
      <li><b>Carb Content Gradient:</b> The annotation bands are colored on a blue-to-red gradient, with blue representing lower total carbs and red representing higher total carbs. This encoding makes it easy to visually identify high-carb and low-carb meals at a glance.</li>
      <li><b>Tooltip Details:</b> Hovering over a food annotation reveals a tooltip with the time, food(s), and nutrient breakdown, providing detailed context without cluttering the main view.</li>
    </ul>
    <p><strong>Interaction Techniques:</strong></p>
    <ul>
      <li><b>Legend-based Patient Selection:</b> Users can click legend items to focus on specific patients, reducing visual clutter and enabling detailed analysis.</li>
      <li><b>Gender Filtering:</b> Checkboxes allow users to filter patients by gender, supporting subgroup analysis.</li>
      <li><b>Reset Button:</b> A reset button restores all selections and filters, making it easy to return to the default view.</li>
      <li><b>Dynamic Carb Legend:</b> When only one patient is selected, a color legend appears to explain the carb gradient, improving interpretability.</li>
    </ul>
    <p><strong>Alternatives Considered:</strong></p>
    <ul>
      <li>We considered using small multiples (one chart per patient), but this would make comparison across patients more difficult and require more screen space.</li>
      <li>We considered using only tooltips for food logs, but the vertical bands provide a much clearer temporal link between meals and glucose changes.</li>
      <li>We considered using categorical color for food annotations, but a gradient encoding provides a more intuitive sense of "more" vs. "less" carbs.</li>
    </ul>
    <p><strong>Final Choices:</strong></p>
    <p>We prioritized clarity, interactivity, and the ability to compare both across and within patients. The combination of line chart, interactive legend, and gradient-encoded annotations best supports these goals.</p>

    <h2>Development Process</h2>
    <p><strong>Motivation:</strong></p>
    <p>We were interested in examining how food intake drives glucose level fluctuations, so we plotted continuous glucose readings over a 24‑hour period, highlighting the timing and magnitude of post‑meal spikes. We also included a macronutrient breakdown for each meal for every patient to allow readers to identify how certain types of foods affect glucose levels.</p>

    <p><strong>Teamwork and Task Division:</strong></p>
    <ul>
      <li>Data wrangling and preprocessing (handling different file formats, date/time normalization)</li>
      <li>Visualization design and D3.js implementation</li>
      <li>Interactive features (legend selection, tooltips, gender filtering)</li>
      <li>Annotation and gradient legend implementation</li>
      <li>Testing and debugging across all patient files</li>
    </ul>
    <p><strong>Time Spent:</strong> The project took approximately <b>12 hours</b> in total.</p>
    <ul>
      <li>Data cleaning and normalization: ~2 hours (handling inconsistent date/time formats was especially time-consuming)</li>
      <li>Visualization and D3.js coding: ~4 hours</li>
      <li>Interactive features and UI polish: ~4 hours</li>
      <li>Testing and debugging: ~2 hours</li>
    </ul>
    <p><strong>Challenges and Commentary:</strong></p>
    <ul>
      <li>The most time-consuming aspect was handling the variety of data formats in the food logs (different date and time fields, inconsistent delimiters, missing values).</li>
      <li>Debugging edge cases for specific patients required careful inspection and flexible code.</li>
      <li>Designing a clear, interactive UI that works for both group and individual analysis required several iterations and user feedback.</li>
      <li>The use of D3.js allowed for powerful custom visualizations, but required careful management of SVG elements and event handlers.</li>
    </ul>
    <p><strong>Summary:</strong> The final application balances clarity, flexibility, and depth of analysis, supporting both overview and detailed exploration of glucose and food log data.</p>
  </section>
</body>
</html>
